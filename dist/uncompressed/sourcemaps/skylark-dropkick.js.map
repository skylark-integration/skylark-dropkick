{"version":3,"sources":["skylark-dropkick.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"../skylark-dropkick.js","sourcesContent":["define('skylark-dropkick/utils',[],function(){\n  const isIE = navigator.appVersion.indexOf(\"MSIE\")!==-1;\n  const Utils = {\n    hasClass( elem, classname ) {\n      let reg = new RegExp( \"(^|\\\\s+)\" + classname + \"(\\\\s+|$)\" );\n\n      return elem && reg.test( elem.className );\n    },\n\n    addClass( elem, classname ) {\n      if( elem && !this.hasClass( elem, classname ) ) {\n        elem.className += \" \" + classname;\n      }\n    },\n\n    removeClass( elem, classname ) {\n      let reg = new RegExp( \"(^|\\\\s+)\" + classname + \"(\\\\s+|$)\" );\n\n      elem && ( elem.className = elem.className.replace( reg, \" \" ) );\n    },\n\n    toggleClass( elem, classname ) {\n      let fn = this.hasClass( elem, classname ) ? \"remove\" : \"add\";\n\n      this[ fn + \"Class\" ]( elem, classname );\n    },\n\n    // Shallow object extend\n    extend( obj ) {\n      Array.prototype.slice.call( arguments, 1 ).forEach( function( source ) {\n        if ( source ) {\n          for ( let prop in source ) obj[ prop ] = source[ prop ];\n        }\n      });\n\n      return obj;\n    },\n\n    // Returns the top and left offset of an element\n    offset( elem ) {\n      let box = elem.getBoundingClientRect() || { top: 0, left: 0 };\n      let docElem = document.documentElement;\n      let offsetTop = isIE ? docElem.scrollTop : window.pageYOffset;\n      let offsetLeft = isIE ? docElem.scrollLeft : window.pageXOffset;\n\n      return {\n        top: box.top + offsetTop - docElem.clientTop,\n        left: box.left + offsetLeft - docElem.clientLeft\n      };\n    },\n\n    // Returns the top and left position of an element relative to an ancestor\n    position( elem, relative ) {\n      let pos = { top: 0, left: 0 };\n\n      while ( elem && elem !== relative ) {\n        pos.top += elem.offsetTop;\n        pos.left += elem.offsetLeft;\n        elem = elem.parentNode;\n      }\n\n      return pos;\n    },\n\n    // Returns the closest ancestor element of the child or false if not found\n    closest( child, ancestor ) {\n      while ( child ) {\n        if ( child === ancestor ) { return child; }\n        child = child.parentNode;\n      }\n\n      return false;\n    },\n\n    // Creates a DOM node with the specified attributes\n    create( name, attrs ) {\n      let a;\n      let node = document.createElement( name );\n\n      if ( !attrs ) { attrs = {}; }\n\n      for ( a in attrs ) {\n        if ( attrs.hasOwnProperty( a ) ) {\n          if ( a === \"innerHTML\" ) {\n            node.innerHTML = attrs[ a ];\n          } else {\n            node.setAttribute( a, attrs[ a ] );\n          }\n        }\n      }\n\n      return node;\n    },\n\n    deferred( fn ) {\n      return function() {\n        window.setTimeout(() => {\n          fn.apply(this, arguments);\n        }, 1);\n      };\n    }\n  };\n\n  return Utils;\n});\n\ndefine('skylark-dropkick/defaults',[],function(){\n  const defaults = {\n    /**\n     * Called once after the DK element is inserted into the DOM.\n     * The value of `this` is the Dropkick object itself.\n     *\n     * @config initialize\n     * @type Function\n     *\n     */\n    initialize() {},\n\n    /**\n     * Whether or not you would like Dropkick to render on mobile devices.\n     *\n     * @default false\n     * @property {boolean} mobile\n     * @type boolean\n     *\n     */\n    mobile: true,\n\n    /**\n     * Called whenever the value of the Dropkick select changes (by user action or through the API).\n     * The value of `this` is the Dropkick object itself.\n     *\n     * @config change\n     * @type Function\n     *\n     */\n    change() {},\n\n    /**\n     * Called whenever the Dropkick select is opened. The value of `this` is the Dropkick object itself.\n     *\n     * @config open\n     * @type Function\n     *\n     */\n    open() {},\n\n    /**\n     * Called whenever the Dropkick select is closed. The value of `this` is the Dropkick object itself.\n     *\n     * @config close\n     * @type Function\n     *\n     */\n    close() {},\n\n    // Search method; \"strict\", \"partial\", or \"fuzzy\"\n    /**\n     * `\"strict\"` - The search string matches exactly from the beginning of the option's text value (case insensitive).\n     *\n     * `\"partial\"` - The search string matches part of the option's text value (case insensitive).\n     *\n     * `\"fuzzy\"` - The search string matches the characters in the given order (not exclusively).\n     * The strongest match is selected first. (case insensitive).\n     *\n     * @default \"strict\"\n     * @config search\n     * @type string\n     *\n     */\n    search: \"strict\",\n\n    /**\n     * Bubble up the custom change event attached to Dropkick to the original element (select).\n     */\n    bubble: true\n  };\n\n  return  defaults;\n\n})\n;\ndefine('skylark-dropkick/Dropkick',[\n  \"skylark-langx/skylark\",\n  \"skylark-jquery\",\n  './utils',\n  './defaults'\n],function(skylark,$,_,defaults){\n    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test( navigator.userAgent );\n    const isIframe = window.parent !== window.self;\n    const noop = function() {};\n    let _docListener;\n\n    /**\n     * # Getting started\n     * After you've cloned the repo you will need to add the library to your page. In the `build/js` folder use\n     * one of the two DropKick files given. One has a version number in the file name and the other is a version\n     * number-less version. You will also need to grab the css from `build/css` and load it on the page.\n     *\n     * Once those files are imported into the page you can call DropKick on any HTMLSelectElement:\n     * `new Dropkick( HTMLSelectElement, Options );` or `new Dropkick( \"ID\", Options );`. This returns the dropkick\n     * object to you. It may be useful for you to store this in a var to reference later.\n     *\n     * If you're using jQuery you can do this instead:\n     * `$('#select').dropkick( Options );`\n     *\n     *\n     * @class Dropkick\n     * @return { object } DropKick Object for that select. You can call your methods on this if stored in a var\n     * @param {elem} sel HTMLSelect Element being passed.\n     * @param {opts} options See list of [properties you can pass in here](#list_of_properties)\n     * @constructor\n     * @example\n     * // Pure JS\n     * var select = new Dropkick(\"#select\");\n     * @example\n     * // jQuery\n     * $(\"#select\").dropkick();\n     */\n    class Dropkick {\n      constructor(select, options) {\n        this.sel = select;\n        let i, dk;\n        let globalDK = window.Dropkick;\n\n        if ( typeof this.sel === \"string\" && this.sel[0] === \"#\" ) {\n          this.sel = document.getElementById( select.substr( 1 ) );\n        }\n\n        // Check if select has already been DK'd and return the DK Object\n        for ( i = 0; i < globalDK.uid; i++) {\n          dk = globalDK.cache[ i ];\n\n          if ( dk instanceof Dropkick && dk.data.select === this.sel ) {\n            _.extend( dk.data.settings, options );\n            return dk;\n          }\n        }\n\n        if ( !this.sel ) {\n          throw \"You must pass a select to DropKick\";\n          return false;\n        }\n\n        if ( this.sel.length < 1 ) {\n          throw `You must have options inside your <select>: ${select}`;\n          return false;\n        }\n\n        if ( this.sel.nodeName === \"SELECT\" ) {\n          return this.init( this.sel, options );\n        }\n      }\n\n      /**\n       * Initializes the DK Object\n       *\n       * @method init\n       * @private\n       * @param  {Node}   sel  [description]\n       * @param  {Object} opts Options to override defaults\n       * @return {Object}      The DK Object\n       */\n      init( sel, opts ) {\n        let globalDK = window.Dropkick;\n        var i,\n            dk =  Dropkick.build( sel, \"dk\" + globalDK.uid );\n\n        // Set some data on the DK Object\n        this.data = {};\n        this.data.select = sel;\n        this.data.elem = dk.elem;\n        this.data.settings = _.extend({}, defaults, opts );\n\n        // Emulate some of HTMLSelectElement's properties\n\n        /**\n         * Whether the form is currently disabled or not\n         *\n         * @property {boolean} disabled\n         * @example\n         * var select = new Dropkick(\"#select\");\n         *\n         * select.disabled;\n         */\n        this.disabled = sel.disabled;\n\n        /**\n         * The form associated with the select\n         *\n         * @property {node} form\n         * @example\n         * var select = new Dropkick(\"#select\");\n         *\n         * select.form;\n         */\n        this.form = sel.form;\n\n        /**\n         * The number of options in the select\n         *\n         * @property {integer} length\n         * @example\n         * var select = new Dropkick(\"#select\");\n         *\n         * select.length;\n         */\n        this.length = sel.length;\n\n        /**\n         * If this select is a multi-select\n         *\n         * @property {boolean} multiple\n         * @example\n         * var select = new Dropkick(\"#select\");\n         *\n         * select.multiple;\n         */\n        this.multiple = sel.multiple;\n\n        /**\n         * An array of Dropkick options\n         *\n         * @property {array} options\n         * @example\n         * var select = new Dropkick(\"#select\");\n         *\n         * select.options;\n         */\n        this.options = dk.options.slice( 0 );\n\n        /**\n         * An index of the first selected option\n         *\n         * @property {integer} selectedIndex\n         * @example\n         * var select = new Dropkick(\"#select\");\n         *\n         * select.selectedIndex;\n         */\n        this.selectedIndex = sel.selectedIndex;\n\n        /**\n         * An array of selected Dropkick options\n         *\n         * @property {array} selectedOptions\n         * @example\n         * var select = new Dropkick(\"#select\");\n         *\n         * select.selectedOptions;\n         */\n        this.selectedOptions = dk.selected.slice( 0 );\n\n        /**\n         * The current value of the select\n         *\n         * @property {string} value\n         * @example\n         * var select = new Dropkick(\"#select\");\n         *\n         * select.value;\n         */\n        this.value = sel.value;\n\n        // Add the DK Object to the cache\n        this.data.cacheID = globalDK.uid;\n        globalDK.cache[ this.data.cacheID ] = this;\n\n        // Call the optional initialize function\n        this.data.settings.initialize.call( this );\n\n        // Increment the index\n        globalDK.uid += 1;\n\n        // Add the change listener to the select\n        if ( !this._changeListener ) {\n          sel.addEventListener( \"change\", this );\n          this._changeListener = true;\n        }\n\n        // Don't continue if we're not rendering on mobile\n        if ( !( isMobile && !this.data.settings.mobile ) ) {\n\n          // Insert the DK element before the original select\n          sel.parentNode.insertBefore( this.data.elem, sel );\n          sel.setAttribute( \"data-dkCacheId\", this.data.cacheID );\n\n          // Bind events\n          this.data.elem.addEventListener( \"click\", this );\n          this.data.elem.addEventListener( \"keydown\", this );\n          this.data.elem.addEventListener( \"keypress\", this );\n\n          if ( this.form ) {\n            this.form.addEventListener( \"reset\", this );\n          }\n\n          if ( !this.multiple ) {\n            for ( i = 0; i < this.options.length; i++ ) {\n              this.options[ i ].addEventListener( \"mouseover\", this );\n            }\n          }\n\n          if ( !_docListener ) {\n            document.addEventListener( \"click\", Dropkick.onDocClick );\n\n            if ( isIframe ){\n              parent.document.addEventListener( \"click\", Dropkick.onDocClick );\n            }\n\n            _docListener = true;\n          }\n        }\n\n        return this;\n      }\n      // Emulate some of HTMLSelectElement's methods\n\n      /**\n       * Adds an element to the select. This option will not only add it to the original\n       * select, but create a Dropkick option and add it to the Dropkick select.\n       *\n       * @method add\n       * @param {string} elem   HTMLOptionElement\n       * @param {Node/Integer} before HTMLOptionElement/Index of Element\n       * @example\n       * var select = new Dropkick(\"#select\");\n       *\n       * select.add(\"New option\", 5);\n       */\n      add( elem, before ) {\n        var text, option, i;\n\n        if ( typeof elem === \"string\" ) {\n          text = elem;\n          elem = document.createElement(\"option\");\n          elem.text = text;\n        }\n\n        if ( elem.nodeName === \"OPTION\" ) {\n          option = _.create( \"li\", {\n            \"class\": \"dk-option\",\n            \"data-value\": elem.value,\n            \"text\": elem.text,\n            \"innerHTML\": elem.innerHTML,\n            \"role\": \"option\",\n            \"aria-selected\": \"false\",\n            \"id\": \"dk\" + this.data.cacheID + \"-\" + ( elem.id || elem.value.replace( \" \", \"-\" ) )\n          });\n\n          _.addClass( option, elem.className );\n          this.length += 1;\n\n          if ( elem.disabled ) {\n            _.addClass( option, \"dk-option-disabled\" );\n            option.setAttribute( \"aria-disabled\", \"true\" );\n          }\n\n          if ( elem.hidden ) {\n            _.addClass( option, \"dk-option-hidden\" );\n            option.setAttribute( \"aria-hidden\", \"true\" );\n          }\n\n          this.data.select.add( elem, before );\n\n          if ( typeof before === \"number\" ) {\n            before = this.item( before );\n          }\n\n          i = this.options.indexOf( before );\n\n          if ( i > -1 ) {\n            before.parentNode.insertBefore( option, before );\n            this.options.splice( i, 0, option );\n          } else {\n            this.data.elem.lastChild.appendChild( option );\n            this.options.push( option );\n          }\n\n          option.addEventListener( \"mouseover\", this );\n\n          if ( elem.selected ) {\n            this.select( i );\n          }\n        }\n      }\n\n      /**\n       * Selects an option in the list at the desired index (negative numbers select from the end).\n       *\n       * @method item\n       * @param  {Integer} index Index of element (positive or negative)\n       * @return {Node}          The DK option from the list, or null if not found\n       * @example\n       * var select = new Dropkick(\"#select\");\n       *\n       * select.item(4); //returns DOM node of index\n       */\n      item( index ) {\n        index = index < 0 ? this.options.length + index : index;\n        return this.options[ index ] || null;\n      }\n\n      /**\n       * Removes the option (from both the select and Dropkick) at the given index.\n       *\n       * @method  remove\n       * @param  {Integer} index Index of element (positive or negative)\n       * @example\n       * var select = new Dropkick(\"#select\");\n       *\n       * select.remove(4);\n       */\n      remove( index ) {\n        let dkOption = this.item( index );\n        dkOption.parentNode.removeChild( dkOption );\n        this.options.splice( index, 1 );\n        this.data.select.remove( index );\n        this.select( this.data.select.selectedIndex );\n        this.length -= 1;\n      }\n\n      /**\n       * Closes the DK dropdown\n       *\n       * @method close\n       * @example\n       * var select = new Dropkick(\"#select\");\n       *\n       * select.close(); //closes dk dropdown\n       */\n      close() {\n        var i,\n            dk = this.data.elem;\n\n        if ( !this.isOpen || this.multiple ) {\n          return false;\n        }\n\n        for ( i = 0; i < this.options.length; i++ ) {\n          _.removeClass( this.options[ i ], \"dk-option-highlight\" );\n        }\n\n        dk.lastChild.setAttribute( \"aria-expanded\", \"false\" );\n        _.removeClass( dk.lastChild, \"dk-select-options-highlight\" );\n        _.removeClass( dk, \"dk-select-open-(up|down)\" );\n        this.isOpen = false;\n\n        this.data.settings.close.call( this );\n      }\n\n      /**\n       * Opens the DK dropdown\n       *\n       * @method open\n       * @example\n       * var select = new Dropkick(\"#select\");\n       *\n       * select.open(); //Opens the dk dropdown\n       */\n      // TODO: This used to run with the deffered util method\n      // is that needed? What problem was that solving?\n      // to make sure this runs in the next animation tick?\n      open() {\n        let dropHeight, above, below, direction, dkTop, dkBottom;\n        let dk = this.data.elem;\n        let dkOptsList = dk.lastChild;\n        // Using MDNs suggestion for crossbrowser scrollY:\n        // https://developer.mozilla.org/en-US/docs/Web/API/Window/scrollY\n        let supportPageOffset = window.pageXOffset !== undefined;\n        let isCSS1Compat = ((document.compatMode || \"\") === \"CSS1Compat\");\n        let scrollY = supportPageOffset ? window.pageYOffset : isCSS1Compat ? document.documentElement.scrollTop : document.body.scrollTop;\n\n        dkTop = _.offset( dk ).top - scrollY;\n        dkBottom = window.innerHeight - ( dkTop + dk.offsetHeight );\n\n        if ( this.isOpen || this.multiple ) { return false; }\n\n        dkOptsList.style.display = \"block\";\n        dropHeight = dkOptsList.offsetHeight;\n        dkOptsList.style.display = \"\";\n\n        above = dkTop > dropHeight;\n        below = dkBottom > dropHeight;\n        direction = above && !below ? \"-up\" : \"-down\";\n\n        this.isOpen = true;\n        _.addClass( dk, \"dk-select-open\" + direction );\n        dkOptsList.setAttribute( \"aria-expanded\", \"true\" );\n        this._scrollTo( this.options.length - 1 );\n        this._scrollTo( this.selectedIndex );\n\n        this.data.settings.open.call( this );\n      }\n\n      /**\n       * Disables or enables an option; if only a boolean is passed (or nothing),\n       * then the entire Dropkick will be disabled or enabled.\n       *\n       * @method disable\n       * @param  {Integer} elem     The element or index to disable\n       * @param  {Boolean}      disabled Value of disabled\n       * @example\n       * var select = new Dropkick(\"#select\");\n       *\n       * // To disable the entire select\n       * select.disable();\n       *\n       * // To disable just an option with an index\n       * select.disable(4, true);\n       *\n       * // To re-enable the entire select\n       * select.disable(false);\n       *\n       * // To re-enable just an option with an index\n       * select.disable(4, false);\n       */\n      disable( elem, disabled ) {\n        var disabledClass = \"dk-option-disabled\";\n\n        if ( arguments.length === 0 || typeof elem === \"boolean\" ) {\n          disabled = elem === undefined ? true : false;\n          elem = this.data.elem;\n          disabledClass = \"dk-select-disabled\";\n          this.disabled = disabled;\n        }\n\n        if ( disabled === undefined ) {\n          disabled = true;\n        }\n\n        if ( typeof elem === \"number\" ) {\n          elem = this.item( elem );\n        }\n\n        if (disabled) {\n          elem.setAttribute( 'aria-disabled', true );\n          _.addClass( elem, disabledClass );\n        } else {\n          elem.setAttribute( 'aria-disabled', false );\n          _.removeClass( elem, disabledClass );\n        }\n      }\n\n      /**\n       * Hides or shows an option.\n       *\n       * @method hide\n       * @param  {Integer} elem     The element or index to hide\n       * @param  {Boolean} hidden   Whether or not to hide the element\n       * @example\n       * var select = new Dropkick(\"#select\");\n       *\n       * // To hide an option with an index\n       * select.hide(4, true);\n       *\n       * // To make an option visible with an index\n       * select.hide(4, false);\n       */\n      hide( elem, hidden ) {\n        var hiddenClass = \"dk-option-hidden\";\n\n        if ( hidden === undefined ) {\n          hidden = true;\n        }\n\n        elem = this.item( elem );\n\n        if (hidden) {\n          elem.setAttribute( 'aria-hidden', true );\n          _.addClass( elem, hiddenClass );\n        } else {\n          elem.setAttribute( 'aria-hidden', false );\n          _.removeClass( elem, hiddenClass );\n        }\n      }\n\n      /**\n       * Selects an option from the list\n       *\n       * @method select\n       * @param  {String} elem     The element, index, or value to select\n       * @param  {Boolean}             disabled Selects disabled options\n       * @return {Node}                         The selected element\n       * @example\n       * var elm = new Dropkick(\"#select\");\n       *\n       * // Select by index\n       * elm.select(4); //selects & returns 5th item in the list\n       *\n       * // Select by value\n       * elm.select(\"AL\"); // selects & returns option with the value \"AL\"\n       */\n      select( elem, disabled ) {\n        var i, index, option, combobox,\n        select = this.data.select;\n\n        if ( typeof elem === \"number\" ) {\n          elem = this.item( elem );\n        }\n\n        if ( typeof elem === \"string\" ) {\n          for ( i = 0; i < this.length; i++ ) {\n            if ( this.options[ i ].getAttribute( \"data-value\" ) === elem ) {\n              elem = this.options[ i ];\n            }\n          }\n        }\n\n        // No element or enabled option\n        if ( !elem || typeof elem === \"string\" ||\n             ( !disabled && _.hasClass( elem, \"dk-option-disabled\" ) ) ) {\n          return false;\n        }\n\n        if ( _.hasClass( elem, \"dk-option\" ) ) {\n          index = this.options.indexOf( elem );\n          option = select.options[ index ];\n\n          if ( this.multiple ) {\n            _.toggleClass( elem, \"dk-option-selected\" );\n            option.selected = !option.selected;\n\n            if ( _.hasClass( elem, \"dk-option-selected\" ) ) {\n              elem.setAttribute( \"aria-selected\", \"true\" );\n              this.selectedOptions.push( elem );\n            } else {\n              elem.setAttribute( \"aria-selected\", \"false\" );\n              index = this.selectedOptions.indexOf( elem );\n              this.selectedOptions.splice( index, 1 );\n            }\n          } else {\n            combobox = this.data.elem.firstChild;\n\n            if ( this.selectedOptions.length ) {\n              _.removeClass( this.selectedOptions[0], \"dk-option-selected\" );\n              this.selectedOptions[0].setAttribute( \"aria-selected\", \"false\" );\n            }\n\n            _.addClass( elem, \"dk-option-selected\" );\n            elem.setAttribute( \"aria-selected\", \"true\" );\n\n            combobox.setAttribute( \"aria-activedescendant\", elem.id );\n            combobox.className = \"dk-selected \" + option.className;\n            combobox.innerHTML = option.innerHTML;\n\n            this.selectedOptions[0] = elem;\n            option.selected = true;\n          }\n\n          this.selectedIndex = select.selectedIndex;\n          this.value = select.value;\n\n          if ( !disabled ) {\n            this.data.select.dispatchEvent( new CustomEvent(\"change\", {bubbles: this.data.settings.bubble}));\n          }\n\n          return elem;\n        }\n      }\n\n      /**\n       * Selects a single option from the list and scrolls to it (if the select is open or on multi-selects).\n       * Useful for selecting an option after a search by the user. Important to note: this doesn't close the\n       * dropdown when selecting. It keeps the dropdown open and scrolls to proper position.\n       *\n       * @method selectOne\n       * @param  {Integer} elem     The element or index to select\n       * @param  {Boolean}      disabled Selects disabled options\n       * @return {Node}                  The selected element\n       * @example\n       * var select = new Dropkick(\"#select\");\n       *\n       * select.selectOne(4);\n       */\n      selectOne( elem, disabled ) {\n        this.reset( true );\n        this._scrollTo( elem );\n        return this.select( elem, disabled );\n      }\n\n      /**\n       * Finds all options who's text matches a pattern (strict, partial, or fuzzy)\n       *\n       * `\"strict\"` - The search string matches exactly from the beginning of the\n       * option's text value (case insensitive).\n       *\n       * `\"partial\"` - The search string matches part of the option's text value\n       * (case insensitive).\n       *\n       * `\"fuzzy\"` - The search string matches the characters in the given order (not\n       * exclusively). The strongest match is selected first. (case insensitive).\n       *\n       * @method search\n       * @param  {String} string  The string to search for\n       * @param  {Integer} mode   How to search; \"strict\", \"partial\", or \"fuzzy\"\n       * @return {Boolean}  An Array of matched elements\n       */\n      search( pattern, mode ) {\n        var i, tokens, str, tIndex, sIndex, cScore, tScore, reg,\n        options = this.data.select.options,\n        matches = [];\n\n        if ( !pattern ) { return this.options; }\n\n        // Fix Mode\n        mode = mode ? mode.toLowerCase() : \"strict\";\n        mode = mode === \"fuzzy\" ? 2 : mode === \"partial\" ? 1 : 0;\n\n        reg = new RegExp( ( mode ? \"\" : \"^\" ) + pattern, \"i\" );\n\n        for ( i = 0; i < options.length; i++ ) {\n          str = options[ i ].text.toLowerCase();\n\n          // Fuzzy\n          if ( mode == 2 ) {\n            tokens = pattern.toLowerCase().split(\"\");\n            tIndex = sIndex = cScore = tScore = 0;\n\n            while ( sIndex < str.length ) {\n              if ( str[ sIndex ] === tokens[ tIndex ] ) {\n                cScore += 1 + cScore;\n                tIndex++;\n              } else {\n                cScore = 0;\n              }\n\n              tScore += cScore;\n              sIndex++;\n            }\n\n            if ( tIndex === tokens.length ) {\n              matches.push({ e: this.options[ i ], s: tScore, i: i });\n            }\n\n            // Partial or Strict (Default)\n          } else {\n            reg.test( str ) && matches.push( this.options[ i ] );\n          }\n        }\n\n        // Sort fuzzy results\n        if ( mode === 2 ) {\n          matches = matches.sort( function ( a, b ) {\n            return ( b.s - a.s ) || a.i - b.i;\n          }).reduce( function ( p, o ) {\n            p[ p.length ] = o.e;\n            return p;\n          }, [] );\n        }\n\n        return matches;\n      }\n\n      /**\n       * Brings focus to the proper DK element\n       *\n       * @method focus\n       * @example\n       * var select = new Dropkick(\"#select\");\n       *\n       * $(\"#some_elm\").on(\"click\", function() {\n       *   select.focus();\n       * });\n       */\n      focus() {\n        if ( !this.disabled ) {\n          ( this.multiple ? this.data.elem : this.data.elem.children[0] ).focus();\n        }\n      }\n\n      /**\n       * Resets the Dropkick and select to it's original selected options; if `clear` is `true`,\n       * It will select the first option by default (or no options for multi-selects).\n       *\n       * @method reset\n       * @param  {Boolean} clear Defaults to first option if true\n       * @example\n       * var select = new Dropkick(\"#select\");\n       *\n       * // Reset to originally `selected` option\n       * select.reset();\n       *\n       * // Reset to first option in select\n       * select.reset(true);\n       */\n      reset( clear ) {\n        var i,\n        select = this.data.select;\n\n        this.selectedOptions.length = 0;\n\n        for ( i = 0; i < select.options.length; i++ ) {\n          select.options[ i ].selected = false;\n          _.removeClass( this.options[ i ], \"dk-option-selected\" );\n          this.options[ i ].setAttribute( \"aria-selected\", \"false\" );\n          if ( !clear && select.options[ i ].defaultSelected ) {\n            this.select( i, true );\n          }\n        }\n\n        if ( !this.selectedOptions.length && !this.multiple ) {\n          this.select( 0, true );\n        }\n      }\n\n      /**\n       * Rebuilds the DK Object\n       * (use if HTMLSelectElement has changed)\n       *\n       * @method refresh\n       * @example\n       * var select = new Dropkick(\"#select\");\n       *\n       * //... [change original select] ...\n       *\n       * select.refresh();\n       */\n      refresh() {\n        if(Object.keys(this).length > 0 && !( isMobile && !this.data.settings.mobile )) {\n          this.dispose().init( this.data.select, this.data.settings );\n        }\n      }\n\n      /**\n       * Removes the DK Object from the cache and the element from the DOM\n       *\n       * @method dispose\n       * @example\n       * var select = new Dropkick(\"#select\");\n       *\n       * select.dispose();\n       */\n      dispose() {\n        let globalDK = window.Dropkick;\n\n        if (Object.keys(this).length > 0 && !( isMobile && !this.data.settings.mobile )) {\n          delete globalDK.cache[ this.data.cacheID ];\n          this.data.elem.parentNode.removeChild( this.data.elem );\n          this.data.select.removeAttribute( \"data-dkCacheId\" );\n        }\n\n        return this;\n      }\n\n      // Private Methods\n\n      /**\n       * @method handleEvent\n       * @private\n       */\n      handleEvent( event ) {\n        if ( this.disabled ) { return; }\n\n        switch ( event.type ) {\n        case \"click\":\n          this._delegate( event );\n          break;\n        case \"keydown\":\n          this._keyHandler( event );\n          break;\n        case \"keypress\":\n          this._searchOptions( event );\n          break;\n        case \"mouseover\":\n          this._highlight( event );\n          break;\n        case \"reset\":\n          this.reset();\n          break;\n        case \"change\":\n          this.data.settings.change.call( this );\n          break;\n        }\n      }\n\n\n      /**\n       * @method delegate\n       * @private\n       */\n      _delegate( event ) {\n        var selection, index, firstIndex, lastIndex,\n        target = event.target;\n\n        if ( _.hasClass( target, \"dk-option-disabled\" ) ) {\n          return false;\n        }\n\n        if ( !this.multiple ) {\n          this[ this.isOpen ? \"close\" : \"open\" ]();\n          if ( _.hasClass( target, \"dk-option\" ) ) { this.select( target ); }\n        } else {\n          if ( _.hasClass( target, \"dk-option\" ) ) {\n            selection = window.getSelection();\n            if ( selection.type === \"Range\" ) selection.collapseToStart();\n\n            if ( event.shiftKey ) {\n              firstIndex = this.options.indexOf( this.selectedOptions[0] );\n              lastIndex = this.options.indexOf( this.selectedOptions[ this.selectedOptions.length - 1 ] );\n              index =  this.options.indexOf( target );\n\n              if ( index > firstIndex && index < lastIndex ) index = firstIndex;\n              if ( index > lastIndex && lastIndex > firstIndex ) lastIndex = firstIndex;\n\n              this.reset( true );\n\n              if ( lastIndex > index ) {\n                while ( index < lastIndex + 1 ) { this.select( index++ ); }\n              } else {\n                while ( index > lastIndex - 1 ) { this.select( index-- ); }\n              }\n            } else if ( event.ctrlKey || event.metaKey ) {\n              this.select( target );\n            } else {\n              this.reset( true );\n              this.select( target );\n            }\n          }\n        }\n      }\n\n      /**\n       * @method highlight\n       * @private\n       */\n      _highlight( event ) {\n        var i, option = event.target;\n\n        if ( !this.multiple ) {\n          for ( i = 0; i < this.options.length; i++ ) {\n            _.removeClass( this.options[ i ], \"dk-option-highlight\" );\n          }\n\n          _.addClass( this.data.elem.lastChild, \"dk-select-options-highlight\" );\n          _.addClass( option, \"dk-option-highlight\" );\n        }\n      }\n\n      /**\n       * @method keyHandler\n       * @private\n       */\n      _keyHandler( event ) {\n        var lastSelected, j,\n        selected = this.selectedOptions,\n        options = this.options,\n        i = 1,\n        keys = {\n          tab: 9,\n          enter: 13,\n          esc: 27,\n          space: 32,\n          up: 38,\n          down: 40\n        };\n\n        switch ( event.keyCode ) {\n        case keys.up:\n          i = -1;\n          // deliberate fallthrough\n        case keys.down:\n          event.preventDefault();\n          lastSelected = selected[ selected.length - 1 ];\n\n          if ( _.hasClass( this.data.elem.lastChild, \"dk-select-options-highlight\" ) ) {\n            _.removeClass( this.data.elem.lastChild, \"dk-select-options-highlight\" );\n            for ( j = 0; j < options.length; j++ ) {\n              if ( _.hasClass( options[ j ], \"dk-option-highlight\" ) ) {\n                _.removeClass( options[ j ], \"dk-option-highlight\" );\n                lastSelected = options[ j ];\n              }\n            }\n          }\n\n          i = options.indexOf( lastSelected ) + i;\n\n          if ( i > options.length - 1 ) {\n            i = options.length - 1;\n          } else if ( i < 0 ) {\n            i = 0;\n          }\n\n          if ( !this.data.select.options[ i ].disabled ) {\n            this.reset( true );\n            this.select( i );\n            this._scrollTo( i );\n          }\n          break;\n        case keys.space:\n          if ( !this.isOpen ) {\n            event.preventDefault();\n            this.open();\n            break;\n          }\n          // deliberate fallthrough\n        case keys.tab:\n        case keys.enter:\n          for ( i = 0; i < options.length; i++ ) {\n            if ( _.hasClass( options[ i ], \"dk-option-highlight\" ) ) {\n              this.select( i );\n            }\n          }\n          // deliberate fallthrough\n        case keys.esc:\n          if ( this.isOpen ) {\n            event.preventDefault();\n            this.close();\n          }\n          break;\n        }\n      }\n\n      /**\n       * @method searchOptions\n       * @private\n       */\n      _searchOptions( event ) {\n        var results,\n            self = this,\n            keyChar = String.fromCharCode( event.keyCode || event.which ),\n\n            waitToReset = function() {\n              if ( self.data.searchTimeout ) {\n                clearTimeout( self.data.searchTimeout );\n              }\n\n              self.data.searchTimeout = setTimeout(function() {\n                self.data.searchString = \"\";\n              }, 1000 );\n            };\n\n        if ( this.data.searchString === undefined ) {\n          this.data.searchString = \"\";\n        }\n\n        waitToReset();\n\n        this.data.searchString += keyChar;\n        results = this.search( this.data.searchString, this.data.settings.search );\n\n        if ( results.length ) {\n          if ( !_.hasClass( results[0], \"dk-option-disabled\" ) ) {\n            this.selectOne( results[0] );\n          }\n        }\n      }\n\n      /**\n       * @method scrollTo\n       * @private\n       */\n      _scrollTo( option ) {\n        var optPos, optTop, optBottom,\n            dkOpts = this.data.elem.lastChild;\n\n        if ( option === -1 || ( typeof option !== \"number\" && !option ) ||\n             ( !this.isOpen && !this.multiple ) ) {\n          return false;\n        }\n\n        if ( typeof option === \"number\" ) {\n          option = this.item( option );\n        }\n\n        optPos = _.position( option, dkOpts ).top;\n        optTop = optPos - dkOpts.scrollTop;\n        optBottom = optTop + option.offsetHeight;\n\n        if ( optBottom > dkOpts.offsetHeight ) {\n          optPos += option.offsetHeight;\n          dkOpts.scrollTop = optPos - dkOpts.offsetHeight;\n        } else if ( optTop < 0 ) {\n          dkOpts.scrollTop = optPos;\n        }\n      }\n    };\n\n    // Cache of DK Objects\n    // currently can't think of a way to do this not in the global space\n    // since DK isn't a singleton.\n\n    // is this cache a must have?\n    window.Dropkick = Dropkick;\n    window.Dropkick.cache = {};\n    window.Dropkick.uid = 0;\n\n    // Static Methods\n\n    /**\n     * Builds the Dropkick element from a select element\n     *\n     * @method  build\n     * @private\n     * @param  {Node} sel The HTMLSelectElement\n     * @return {Object}   An object containing the new DK element and it's options\n     */\n    Dropkick.build = function( sel, idpre ) {\n      var selOpt, optList, i,\n          options = [],\n\n          ret = {\n            elem: null,\n            options: [],\n            selected: []\n          },\n\n          addOption = function ( node ) {\n            var option, optgroup, optgroupList, i,\n                children = [];\n\n            switch ( node.nodeName ) {\n            case \"OPTION\":\n              option = _.create( \"li\", {\n                \"class\": \"dk-option \",\n                \"data-value\": node.value,\n                \"text\": node.text,\n                \"innerHTML\": node.innerHTML,\n                \"role\": \"option\",\n                \"aria-selected\": \"false\",\n                \"id\": idpre + \"-\" + ( node.id || node.value.replace( \" \", \"-\" ) )\n              });\n\n              _.addClass( option, node.className );\n\n              if ( node.disabled ) {\n                _.addClass( option, \"dk-option-disabled\" );\n                option.setAttribute( \"aria-disabled\", \"true\" );\n              }\n\n              if ( node.hidden ) {\n                _.addClass( option, \"dk-option-hidden\" );\n                option.setAttribute( \"aria-hidden\", \"true\" );\n              }\n\n              if ( node.selected ) {\n                _.addClass( option, \"dk-option-selected\" );\n                option.setAttribute( \"aria-selected\", \"true\" );\n                ret.selected.push( option );\n              }\n\n              ret.options.push( this.appendChild( option ) );\n              break;\n            case \"OPTGROUP\":\n              optgroup = _.create( \"li\", { \"class\": \"dk-optgroup\" });\n\n              if ( node.label ) {\n                optgroup.appendChild( _.create( \"div\", {\n                  \"class\": \"dk-optgroup-label\",\n                  \"innerHTML\": node.label\n                }));\n              }\n\n              optgroupList = _.create( \"ul\", {\n                \"class\": \"dk-optgroup-options\"\n              });\n\n              for ( i = node.children.length; i--; children.unshift( node.children[ i ] ) );\n\n              if (node.disabled) {\n                optgroup.classList.add('dk-optgroup-disabled');\n\n                children.forEach(option => {\n                  option.disabled = node.disabled;\n                });\n              }\n\n              children.forEach( addOption, optgroupList );\n\n              this.appendChild( optgroup ).appendChild( optgroupList );\n              break;\n            }\n          };\n\n      ret.elem = _.create( \"div\", {\n        \"class\": \"dk-select\" + ( sel.multiple ? \"-multi\" : \"\" )\n      });\n\n      optList = _.create( \"ul\", {\n        \"class\": \"dk-select-options\",\n        \"id\": idpre + \"-listbox\",\n        \"role\": \"listbox\"\n      });\n\n      if (sel.disabled) {\n        _.addClass( ret.elem, \"dk-select-disabled\" );\n        ret.elem.setAttribute( 'aria-disabled', true );\n      }\n      ret.elem.id = idpre + ( sel.id ? \"-\" + sel.id : \"\" );\n      _.addClass( ret.elem, sel.className );\n\n      if ( !sel.multiple ) {\n        selOpt = sel.options[ sel.selectedIndex ];\n        ret.elem.appendChild( _.create( \"div\", {\n          \"class\": \"dk-selected \" + ( selOpt ? selOpt.className : \"\" ),\n          \"tabindex\": sel.tabindex || 0,\n          \"innerHTML\": selOpt ? selOpt.text : '&nbsp;',\n          \"id\": idpre + \"-combobox\",\n          \"aria-live\": \"assertive\",\n          \"aria-owns\": optList.id,\n          \"role\": \"combobox\"\n        }));\n        optList.setAttribute( \"aria-expanded\", \"false\" );\n      } else {\n        ret.elem.setAttribute( \"tabindex\", sel.getAttribute( \"tabindex\" ) || \"0\" );\n        optList.setAttribute( \"aria-multiselectable\", \"true\" );\n      }\n\n      for ( i = sel.children.length; i--; options.unshift( sel.children[ i ] ) );\n      options.forEach( addOption, ret.elem.appendChild( optList ) );\n\n      return ret;\n    };\n\n    /**\n     * Focus DK Element when corresponding label is clicked; close all other DK's\n     *\n     * @method  onDocClick\n     * @private\n     * @param {Object} event  Event from document click\n     */\n    Dropkick.onDocClick = function( event ) {\n      var tId, i;\n      let globalDK = window.Dropkick;\n\n      if (event.target.nodeType !== 1) {\n        return false;\n      }\n\n      if ( ( tId = event.target.getAttribute( \"data-dkcacheid\" ) ) !== null ) {\n        globalDK.cache[ tId ].focus();\n      }\n\n      for ( i in globalDK.cache ) {\n        if ( !_.closest( event.target, globalDK.cache[ i ].data.elem ) && i !== tId ) {\n          globalDK.cache[ i ].disabled || globalDK.cache[ i ].close();\n        }\n      }\n    };\n\n\n    // Add jQuery method\n    $.fn.dropkick = function () {\n        var args = Array.prototype.slice.call( arguments );\n        return $( this ).each(function() {\n          if ( !args[0] || typeof args[0] === 'object' ) {\n            new Dropkick( this, args[0] || {} );\n          } else if ( typeof args[0] === 'string' ) {\n            Dropkick.prototype[ args[0] ].apply( new Dropkick( this ), args.slice( 1 ) );\n          }\n        });\n    };\n\n\n    return skylark.attach(\"intg.Dropkick\",Dropkick);\n});\ndefine('skylark-dropkick/main',[\r\n\t\"./Dropkick\"\r\n],function(Dropkick){\r\n\treturn Dropkick\r\n});\ndefine('skylark-dropkick', ['skylark-dropkick/main'], function (main) { return main; });\n\n"]}